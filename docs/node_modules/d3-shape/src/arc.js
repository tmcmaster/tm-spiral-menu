define(["exports","../../d3-path/index.js","./constant.js","./math.js"],function(_exports,_index,_constant,_math){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.default=_default;_constant=babelHelpers.interopRequireDefault(_constant);var _Mathsqrt=Math.sqrt;function arcInnerRadius(d){return d.innerRadius}function arcOuterRadius(d){return d.outerRadius}function arcStartAngle(d){return d.startAngle}function arcEndAngle(d){return d.endAngle}function arcPadAngle(d){return d&&d.padAngle}function asin(x){return 1<=x?_math.halfPi:-1>=x?-_math.halfPi:Math.asin(x)}function intersect(x0,y0,x1,y1,x2,y2,x3,y3){var x10=x1-x0,y10=y1-y0,x32=x3-x2,y32=y3-y2,t=(x32*(y0-y2)-y32*(x0-x2))/(y32*x10-x32*y10);return[x0+t*x10,y0+t*y10]}function cornerTangents(x0,y0,x1,y1,r1,rc,cw){var x01=x0-x1,y01=y0-y1,lo=(cw?rc:-rc)/_Mathsqrt(x01*x01+y01*y01),ox=lo*y01,oy=-lo*x01,x11=x0+ox,y11=y0+oy,x10=x1+ox,y10=y1+oy,x00=(x11+x10)/2,y00=(y11+y10)/2,dx=x10-x11,dy=y10-y11,d2=dx*dx+dy*dy,r=r1-rc,D=x11*y10-x10*y11,d=(0>dy?-1:1)*_Mathsqrt(Math.max(0,r*r*d2-D*D)),cx0=(D*dy-dx*d)/d2,cy0=(-D*dx-dy*d)/d2,cx1=(D*dy+dx*d)/d2,cy1=(-D*dx+dy*d)/d2,dx0=cx0-x00,dy0=cy0-y00,dx1=cx1-x00,dy1=cy1-y00;if(dx0*dx0+dy0*dy0>dx1*dx1+dy1*dy1)cx0=cx1,cy0=cy1;return{cx:cx0,cy:cy0,x01:-ox,y01:-oy,x11:cx0*(r1/r-1),y11:cy0*(r1/r-1)}}function _default(){var _Mathsin=Math.sin,_Mathcos=Math.cos,innerRadius=arcInnerRadius,outerRadius=arcOuterRadius,cornerRadius=(0,_constant.default)(0),padRadius=null,startAngle=arcStartAngle,endAngle=arcEndAngle,padAngle=arcPadAngle,context=null;function arc(){var _Mathatan=Math.atan2,_Mathmin=Math.min,_Mathabs=Math.abs,buffer,r,r0=+innerRadius.apply(this,arguments),r1=+outerRadius.apply(this,arguments),a0=startAngle.apply(this,arguments)-_math.halfPi,a1=endAngle.apply(this,arguments)-_math.halfPi,da=_Mathabs(a1-a0),cw=a1>a0;if(!context)context=buffer=(0,_index.path)();if(r1<r0)r=r1,r1=r0,r0=r;if(!(r1>_math.epsilon))context.moveTo(0,0);else if(da>_math.tau-_math.epsilon){context.moveTo(r1*_Mathcos(a0),r1*_Mathsin(a0));context.arc(0,0,r1,a0,a1,!cw);if(r0>_math.epsilon){context.moveTo(r0*_Mathcos(a1),r0*_Mathsin(a1));context.arc(0,0,r0,a1,a0,cw)}}else{var a01=a0,a11=a1,a00=a0,a10=a1,da0=da,da1=da,ap=padAngle.apply(this,arguments)/2,rp=ap>_math.epsilon&&(padRadius?+padRadius.apply(this,arguments):_Mathsqrt(r0*r0+r1*r1)),rc=_Mathmin(_Mathabs(r1-r0)/2,+cornerRadius.apply(this,arguments)),rc0=rc,rc1=rc,t0,t1;if(rp>_math.epsilon){var p0=asin(rp/r0*_Mathsin(ap)),p1=asin(rp/r1*_Mathsin(ap));if((da0-=2*p0)>_math.epsilon)p0*=cw?1:-1,a00+=p0,a10-=p0;else da0=0,a00=a10=(a0+a1)/2;if((da1-=2*p1)>_math.epsilon)p1*=cw?1:-1,a01+=p1,a11-=p1;else da1=0,a01=a11=(a0+a1)/2}var x01=r1*_Mathcos(a01),y01=r1*_Mathsin(a01),x10=r0*_Mathcos(a10),y10=r0*_Mathsin(a10);if(rc>_math.epsilon){var x11=r1*_Mathcos(a11),y11=r1*_Mathsin(a11),x00=r0*_Mathcos(a00),y00=r0*_Mathsin(a00);if(da<_math.pi){var oc=da0>_math.epsilon?intersect(x01,y01,x00,y00,x11,y11,x10,y10):[x10,y10],ax=x01-oc[0],ay=y01-oc[1],bx=x11-oc[0],by=y11-oc[1],kc=1/_Mathsin(Math.acos((ax*bx+ay*by)/(_Mathsqrt(ax*ax+ay*ay)*_Mathsqrt(bx*bx+by*by)))/2),lc=_Mathsqrt(oc[0]*oc[0]+oc[1]*oc[1]);rc0=_Mathmin(rc,(r0-lc)/(kc-1));rc1=_Mathmin(rc,(r1-lc)/(kc+1))}}if(!(da1>_math.epsilon))context.moveTo(x01,y01);else if(rc1>_math.epsilon){t0=cornerTangents(x00,y00,x01,y01,r1,rc1,cw);t1=cornerTangents(x11,y11,x10,y10,r1,rc1,cw);context.moveTo(t0.cx+t0.x01,t0.cy+t0.y01);if(rc1<rc)context.arc(t0.cx,t0.cy,rc1,_Mathatan(t0.y01,t0.x01),_Mathatan(t1.y01,t1.x01),!cw);else{context.arc(t0.cx,t0.cy,rc1,_Mathatan(t0.y01,t0.x01),_Mathatan(t0.y11,t0.x11),!cw);context.arc(0,0,r1,_Mathatan(t0.cy+t0.y11,t0.cx+t0.x11),_Mathatan(t1.cy+t1.y11,t1.cx+t1.x11),!cw);context.arc(t1.cx,t1.cy,rc1,_Mathatan(t1.y11,t1.x11),_Mathatan(t1.y01,t1.x01),!cw)}}else context.moveTo(x01,y01),context.arc(0,0,r1,a01,a11,!cw);if(!(r0>_math.epsilon)||!(da0>_math.epsilon))context.lineTo(x10,y10);else if(rc0>_math.epsilon){t0=cornerTangents(x10,y10,x11,y11,r0,-rc0,cw);t1=cornerTangents(x01,y01,x00,y00,r0,-rc0,cw);context.lineTo(t0.cx+t0.x01,t0.cy+t0.y01);if(rc0<rc)context.arc(t0.cx,t0.cy,rc0,_Mathatan(t0.y01,t0.x01),_Mathatan(t1.y01,t1.x01),!cw);else{context.arc(t0.cx,t0.cy,rc0,_Mathatan(t0.y01,t0.x01),_Mathatan(t0.y11,t0.x11),!cw);context.arc(0,0,r0,_Mathatan(t0.cy+t0.y11,t0.cx+t0.x11),_Mathatan(t1.cy+t1.y11,t1.cx+t1.x11),cw);context.arc(t1.cx,t1.cy,rc0,_Mathatan(t1.y11,t1.x11),_Mathatan(t1.y01,t1.x01),!cw)}}else context.arc(0,0,r0,a10,a00,cw)}context.closePath();if(buffer)return context=null,buffer+""||null}arc.centroid=function(){var r=(+innerRadius.apply(this,arguments)+ +outerRadius.apply(this,arguments))/2,a=(+startAngle.apply(this,arguments)+ +endAngle.apply(this,arguments))/2-_math.pi/2;return[_Mathcos(a)*r,_Mathsin(a)*r]};arc.innerRadius=function(_){return arguments.length?(innerRadius="function"===typeof _?_:(0,_constant.default)(+_),arc):innerRadius};arc.outerRadius=function(_){return arguments.length?(outerRadius="function"===typeof _?_:(0,_constant.default)(+_),arc):outerRadius};arc.cornerRadius=function(_){return arguments.length?(cornerRadius="function"===typeof _?_:(0,_constant.default)(+_),arc):cornerRadius};arc.padRadius=function(_){return arguments.length?(padRadius=null==_?null:"function"===typeof _?_:(0,_constant.default)(+_),arc):padRadius};arc.startAngle=function(_){return arguments.length?(startAngle="function"===typeof _?_:(0,_constant.default)(+_),arc):startAngle};arc.endAngle=function(_){return arguments.length?(endAngle="function"===typeof _?_:(0,_constant.default)(+_),arc):endAngle};arc.padAngle=function(_){return arguments.length?(padAngle="function"===typeof _?_:(0,_constant.default)(+_),arc):padAngle};arc.context=function(_){return arguments.length?(context=null==_?null:_,arc):context};return arc}});